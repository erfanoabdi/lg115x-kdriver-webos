/** @file
 *
 *  secure core driver
 *
 *  @author		stan.kim@lge.com
 *  @version	1.0
 *  @date		2014.1
 *  @note		Additional information.
 */

/*----------------------------------------------------------------------------------------
 *   Control Constants
 *---------------------------------------------------------------------------------------*/

/*----------------------------------------------------------------------------------------
 *   File Inclusions
 *---------------------------------------------------------------------------------------*/
#include <linux/module.h>
#include <linux/sched.h>
#include "sc_if.h"

/*----------------------------------------------------------------------------------------
 *   Constant Definitions
 *---------------------------------------------------------------------------------------*/

/*----------------------------------------------------------------------------------------
 *   Macro Definitions
 *---------------------------------------------------------------------------------------*/

/*----------------------------------------------------------------------------------------
 *   Type Definitions
 *---------------------------------------------------------------------------------------*/

/*----------------------------------------------------------------------------------------
 *   External Function Prototype Declarations
 *---------------------------------------------------------------------------------------*/

/*----------------------------------------------------------------------------------------
 *   External Variables
 *---------------------------------------------------------------------------------------*/

/*----------------------------------------------------------------------------------------
 *   global Functions
 *---------------------------------------------------------------------------------------*/

/*----------------------------------------------------------------------------------------
 *   global Variables
 *---------------------------------------------------------------------------------------*/

/*----------------------------------------------------------------------------------------
 *   Static Function Prototypes Declarations
 *---------------------------------------------------------------------------------------*/

/*----------------------------------------------------------------------------------------
 *   Static Variables
 *---------------------------------------------------------------------------------------*/
static SC_IF_T _gSC_IF = { NULL };

/*========================================================================================
	Implementation Group
========================================================================================*/

long long SC_IF_Clock(void)
{
	return sched_clock();
}
EXPORT_SYMBOL(SC_IF_Clock);

SC_IF_RETURN_T SC_IF_Init(SC_IF_T *pScIf)
{
	if (pScIf==NULL)
		return SC_IF_ERROR;

	memcpy(&_gSC_IF, pScIf, sizeof(SC_IF_T));

	return SC_IF_OK;
}
EXPORT_SYMBOL(SC_IF_Init);

SC_IF_RETURN_T SC_IF_RunCommand(int command)
{
	if (_gSC_IF.SC_IF_RunCommand == NULL)
		return SC_IF_ERROR;

	return _gSC_IF.SC_IF_RunCommand(command);
}
EXPORT_SYMBOL(SC_IF_RunCommand);

SC_IF_RETURN_T SC_IF_DecryptCW(unsigned char *pCW, int cwLength)
{
	if (_gSC_IF.SC_IF_DecryptCW == NULL)
		return SC_IF_ERROR;

	return _gSC_IF.SC_IF_DecryptCW(pCW, cwLength);
}
EXPORT_SYMBOL(SC_IF_DecryptCW);

SC_IF_RETURN_T SC_IF_DecryptContent(SC_IF_AU_T *pAu, SC_IF_CPB_T *pIn, SC_IF_CPB_T *pOut, int bInit)
{
	if (_gSC_IF.SC_IF_DecryptContent == NULL)
		return SC_IF_ERROR;

	return _gSC_IF.SC_IF_DecryptContent(pAu, pIn, pOut, bInit);
}
EXPORT_SYMBOL(SC_IF_DecryptContent);


